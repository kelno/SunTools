define(["durandal/system","durandal/composition","jquery"],function(e,t,n){var i=50,r={marginRight:0,marginLeft:0,opacity:1},o={marginLeft:"",marginRight:"",opacity:"",display:""},a=function(t){return e.defer(function(e){function a(){e.resolve()}function c(){t.keepScrollPosition||n(document).scrollTop(0)}function s(){c(),t.triggerAttach();var e={marginLeft:"0",marginRight:"0",opacity:0,display:"block"},i=n(t.child);i.css(e),i.animate(r,{duration:u,always:function(){i.css(o),a()}})}if(t.child){var u=t.duration||500;t.activeView?n(t.activeView).fadeOut({duration:i,always:s}):s()}else n(t.activeView).fadeOut(i,a)}).promise()};return a});